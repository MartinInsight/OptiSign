<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Logistics Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/main.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="dashboard-grid">
        <header class="bg-blue-900 text-white p-6 rounded-xl shadow-lg col-span-full text-center mb-0">
            <h1 class="text-4xl font-bold mb-2">글로벌 물류 대시보드</h1>
            <p class="text-lg opacity-90">주요 해상 운임 지수 및 물류 데이터</p>
        </header>

        <!-- Chart Slider Container -->
        <div class="chart-slider-container bg-white rounded-xl shadow-md p-6 relative overflow-hidden col-span-2 min-h-[350px] flex flex-col items-center justify-center">
            <!-- Chart Slides -->
            <div class="chart-slide active absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: KCCI</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="salesChart"></canvas>
                </div>
            </div>
            <div class="chart-slide absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: SCFI</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="expensesChart"></canvas>
                </div>
            </div>
            <div class="chart-slide absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: WCI</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="productSalesChart"></canvas>
                </div>
            </div>
            <div class="chart-slide absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: IACI</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="inventoryChart"></canvas>
                </div>
            </div>
            <div class="chart-slide absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: Blank Sailings</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="satisfactionChart"></canvas>
                </div>
            </div>
            <div class="chart-slide absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: FBX</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="trafficChart"></canvas>
                </div>
            </div>
            <div class="chart-slide absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: XSI</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="productivityChart"></canvas>
                </div>
            </div>
            <div class="chart-slide absolute inset-0 p-6 flex flex-col justify-center items-center">
                <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center">Container Index: MBCI</h2>
                <div class="chart-container relative w-full h-[250px]">
                    <canvas id="mbciChart"></canvas>
                </div>
            </div>
            <p class="placeholder-text absolute bottom-4 left-1/2 -translate-x-1/2 text-sm text-gray-500">Charts will cycle every 10 seconds.</p>
        </div>

        <!-- World Clock Card -->
        <div class="world-clock-card card bg-white rounded-xl shadow-md p-6 flex flex-col justify-between items-start">
            <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center w-full">World Clocks</h2>
            <div class="clocks-container grid grid-cols-3 gap-4 w-full mt-2">
                <div class="clock-item bg-gray-50 border border-gray-200 rounded-lg p-3 text-center shadow-sm">
                    <h3 class="text-lg font-medium text-blue-900 mb-1">Los Angeles</h3>
                    <p id="time-la" class="text-2xl font-bold text-gray-700">--:--:--</p>
                </div>
                <div class="clock-item bg-gray-50 border border-gray-200 rounded-lg p-3 text-center shadow-sm">
                    <h3 class="text-lg font-medium text-blue-900 mb-1">New York</h3>
                    <p id="time-ny" class="text-2xl font-bold text-gray-700">--:--:--</p>
                </div>
                <div class="clock-item bg-gray-50 border border-gray-200 rounded-lg p-3 text-center shadow-sm">
                    <h3 class="text-lg font-medium text-blue-900 mb-1">Paris</h3>
                    <p id="time-paris" class="text-2xl font-bold text-gray-700">--:--:--</p>
                </div>
                <div class="clock-item bg-gray-50 border border-gray-200 rounded-lg p-3 text-center shadow-sm">
                    <h3 class="text-lg font-medium text-blue-900 mb-1">Shanghai</h3>
                    <p id="time-shanghai" class="text-2xl font-bold text-gray-700">--:--:--</p>
                </div>
                <div class="clock-item bg-gray-50 border border-gray-200 rounded-lg p-3 text-center shadow-sm">
                    <h3 class="text-lg font-medium text-blue-900 mb-1">Seoul</h3>
                    <p id="time-seoul" class="text-2xl font-bold text-gray-700">--:--:--</p>
                </div>
                <div class="clock-item bg-gray-50 border border-gray-200 rounded-lg p-3 text-center shadow-sm">
                    <h3 class="text-lg font-medium text-blue-900 mb-1">Sydney</h3>
                    <p id="time-sydney" class="text-2xl font-bold text-gray-700">--:--:--</p>
                </div>
            </div>
        </div>

        <!-- Weather Card (Placeholder) -->
        <div class="weather-card card bg-white rounded-xl shadow-md p-6 flex flex-col justify-between items-start">
            <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center w-full">Current Weather (Seoul)</h2>
            <div class="weather-info flex flex-col items-center w-full mb-4">
                <img id="weather-icon" src="https://openweathermap.org/img/wn/01d@2x.png" alt="Weather Icon" class="w-20 h-20">
                <p id="temperature" class="text-5xl font-bold text-teal-700 my-1">25°C</p>
                <p id="description" class="text-xl text-gray-600 capitalize">Clear Sky</p>
                <p id="city-name" class="text-2xl font-bold text-gray-700 mt-2">Seoul</p>
            </div>
            <p class="placeholder-text text-sm text-gray-500 w-full text-center">Weather data is static for demonstration.</p>
        </div>

        <!-- Exchange Rate Card (Placeholder) -->
        <div class="exchange-rate-card card bg-white rounded-xl shadow-md p-6 flex flex-col justify-between items-start">
            <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center w-full">Exchange Rates</h2>
            <div class="exchange-rates w-full mb-4">
                <p class="text-lg text-gray-700 flex justify-between items-center py-1 border-b border-dashed border-gray-200">USD/KRW: <span class="font-bold text-teal-700">1,350.50</span></p>
                <p class="text-lg text-gray-700 flex justify-between items-center py-1 border-b border-dashed border-gray-200">EUR/KRW: <span class="font-bold text-teal-700">1,480.20</span></p>
                <p class="text-lg text-gray-700 flex justify-between items-center py-1">JPY/KRW (100): <span class="font-bold text-teal-700">9.15</span></p>
            </div>
            <p class="placeholder-text text-sm text-gray-500 w-full text-center">Exchange rate data is static for demonstration.</p>
        </div>

        <!-- Info Card -->
        <div class="info-card card bg-white rounded-xl shadow-md p-6 flex flex-col justify-between items-start col-span-full">
            <h2 class="text-2xl font-semibold text-blue-900 mb-4 text-center w-full">Notice & Information</h2>
            <p class="text-base text-gray-600 leading-relaxed text-center mt-2">
                This dashboard provides real-time and historical data on global shipping indices.
                Data is updated periodically. For detailed analysis or specific data requests, please contact the administrator.
                All data is for informational purposes only and should not be used for trading or investment decisions.
            </p>
            <p id="last-updated" class="text-sm text-gray-500 mt-4 w-full text-center">Last Updated: --:--:--</p>
        </div>
    </div>

    <script>
        // Chart instances global variables
        let salesChart;
        let expensesChart;
        let productSalesChart;
        let inventoryChart;
        let satisfactionChart;
        let trafficChart;
        let productivityChart;
        let mbciChart; // Added MBCI Chart instance

        // Path to the JSON data file generated by the Python script
        const DATA_JSON_URL = 'data/crawling_data.json';

        document.addEventListener('DOMContentLoaded', () => {
            // --- Chart Initialization Function ---
            // This function creates or updates a Chart.js instance.
            // It now accepts an array of datasets for multi-line/bar charts.
            const setupChart = (chartId, type, datasets, labels = [], additionalOptions = {}) => {
                const ctx = document.getElementById(chartId);
                if (ctx) {
                    // Destroy existing chart instance if it exists to prevent conflicts
                    if (Chart.getChart(chartId)) {
                        Chart.getChart(chartId).destroy();
                    }

                    const defaultOptions = {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'Date' // Default X-axis title
                                }
                            },
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Value' // Default Y-axis title
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false
                            }
                        }
                    };

                    // Merge default options with any additional options provided
                    const options = { ...defaultOptions, ...additionalOptions };
                    if (options.scales && additionalOptions.scales) {
                        options.scales = { ...defaultOptions.scales, ...additionalOptions.scales };
                        if (options.scales.x && additionalOptions.scales.x) {
                            options.scales.x = { ...defaultOptions.scales.x, ...additionalOptions.scales.x };
                        }
                        if (options.scales.y && additionalOptions.scales.y) {
                            options.scales.y = { ...defaultOptions.scales.y, ...additionalOptions.scales.y };
                        }
                    }

                    // Ensure fill property is set correctly for each dataset
                    const processedDatasets = datasets.map(dataset => ({
                        ...dataset,
                        // Removed hidden: true, so all datasets will be visible by default
                        fill: dataset.fill !== undefined ? dataset.fill : (type === 'line' || type === 'radar' || type === 'polarArea'),
                        pointRadius: dataset.pointRadius !== undefined ? dataset.pointRadius : 3, // Default point radius
                        tension: dataset.tension !== undefined ? dataset.tension : 0.4, // Default tension for smoother lines
                        spanGaps: true // Connect lines across null/NaN values
                    }));


                    return new Chart(ctx, {
                        type: type,
                        data: {
                            labels: labels,
                            datasets: processedDatasets // Now directly use the array of datasets
                        },
                        options: options
                    });
                }
                return null;
            };

            // --- Chart Slider Logic ---
            const chartSlides = document.querySelectorAll('.chart-slide');
            let currentChartSlide = 0;
            const chartSlideInterval = 10000; // 10 seconds (in milliseconds)

            function showChartSlide(index) {
                chartSlides.forEach((slide, i) => {
                    if (i === index) {
                        slide.classList.add('active');
                    } else {
                        slide.classList.remove('active');
                    }
                });
            }

            function nextChartSlide() {
                currentChartSlide = (currentChartSlide + 1) % chartSlides.length;
                showChartSlide(currentChartSlide);
            }

            // --- World Clock Logic ---
            // Map of city keys (matching HTML IDs) to IANA time zone identifiers
            const cityTimezones = {
                'la': 'America/Los_Angeles',
                'ny': 'America/New_York',
                'paris': 'Europe/Paris',
                'shanghai': 'Asia/Shanghai',
                'seoul': 'Asia/Seoul',
                'sydney': 'Australia/Sydney'
            };

            function updateWorldClocks() {
                const now = new Date(); // Get current time (UTC)

                for (const cityKey in cityTimezones) {
                    const timezone = cityTimezones[cityKey];
                    const options = {
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: false, // 24-hour format
                        timeZone: timezone // Apply the specific city's time zone
                    };
                    // Intl.DateTimeFormat automatically handles Daylight Saving Time
                    const timeString = new Intl.DateTimeFormat('en-US', options).format(now);
                    
                    const elementId = `time-${cityKey}`; // Construct HTML ID (e.g., 'time-la')
                    const timeElement = document.getElementById(elementId);
                    if (timeElement) {
                        timeElement.textContent = timeString;
                    }
                }
            }

            // --- Data Loading and Dashboard Update Function ---
            async function loadAndDisplayData() {
                let rawData = [];
                try {
                    const response = await fetch(DATA_JSON_URL);
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    rawData = await response.json();
                    console.log("Loaded data:", rawData);

                    if (rawData.length === 0) {
                        console.warn("No data found in the JSON file.");
                        // Optionally display a message on the dashboard if no data
                        document.querySelector('.chart-slider-container').innerHTML = '<p class="placeholder-text">No chart data available.</p>';
                        return;
                    }

                    // --- Prepare Chart Data and Initialize Charts ---
                    const dates = rawData.map(item => item.date); // X-axis labels (dates)

                    // Color palette for multiple datasets
                    const colors = [
                        'rgba(0, 101, 126, 0.8)', // Main Teal
                        'rgba(0, 58, 82, 0.8)',  // Main Navy
                        'rgba(75, 192, 192, 0.8)', // Green-ish Teal
                        'rgba(153, 102, 255, 0.8)',// Purple
                        'rgba(255, 159, 64, 0.8)', // Orange
                        'rgba(255, 99, 132, 0.8)', // Red
                        'rgba(54, 162, 235, 0.8)', // Blue
                        'rgba(201, 203, 207, 0.8)',// Grey
                        'rgba(255, 205, 86, 0.8)', // Yellow
                        'rgba(100, 100, 100, 0.8)',// Dark Grey
                        'rgba(0, 200, 150, 0.8)',  // Bright Teal
                        'rgba(150, 50, 200, 0.8)', // Dark Purple
                        'rgba(200, 150, 0, 0.8)',  // Gold
                        'rgba(50, 200, 0, 0.8)',   // Lime Green
                        'rgba(0, 50, 200, 0.8)'    // Dark Blue
                    ];
                    const borderColors = [
                        '#00657e', // Darker Teal
                        '#003A52',  // Darker Navy
                        '#4b8f8f', // Darker Green-ish Teal
                        '#7a52cc', // Darker Purple
                        '#cc7a33', // Darker Orange
                        '#cc4f6a', // Darker Red
                        '#2a7bc9', // Darker Blue
                        '#a0a2a5', // Darker Grey
                        '#ccaa44', // Darker Yellow
                        '#505050', // Even Darker Grey
                        '#00a078',  // Darker Bright Teal
                        '#7828a0', // Even Darker Purple
                        '#a07800',  // Darker Gold
                        '#28a000',   // Darker Lime Green
                        '#0028a0'    // Even Darker Blue
                    ];


                    // Chart 1: KCCI Composite Index & Routes
                    salesChart = setupChart(
                        'salesChart', 'line',
                        [
                            {
                                label: 'KCCI Composite Index',
                                data: rawData.map(item => item.KCCI_Composite_Index),
                                backgroundColor: colors[0],
                                borderColor: borderColors[0],
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'KCCI US West Coast',
                                data: rawData.map(item => item.KCCI_US_West_Coast),
                                backgroundColor: colors[2],
                                borderColor: borderColors[2],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'KCCI US East Coast',
                                data: rawData.map(item => item.KCCI_US_East_Coast),
                                backgroundColor: colors[3],
                                borderColor: borderColors[3],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'KCCI Europe',
                                data: rawData.map(item => item.KCCI_Europe),
                                backgroundColor: colors[4],
                                borderColor: borderColors[4],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'KCCI Mediterranean',
                                data: rawData.map(item => item.KCCI_Mediterranean),
                                backgroundColor: colors[5],
                                borderColor: borderColors[5],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI Middle East',
                                data: rawData.map(item => item.KCCI_Middle_East),
                                backgroundColor: colors[6],
                                borderColor: borderColors[6],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI Australia',
                                data: rawData.map(item => item.KCCI_Australia),
                                backgroundColor: colors[7],
                                borderColor: borderColors[7],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI South America East Coast',
                                data: rawData.map(item => item.KCCI_South_America_East_Coast),
                                backgroundColor: colors[8],
                                borderColor: borderColors[8],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI South America West Coast',
                                data: rawData.map(item => item.KCCI_South_America_West_Coast),
                                backgroundColor: colors[9],
                                borderColor: borderColors[9],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI South Africa',
                                data: rawData.map(item => item.KCCI_South_Africa),
                                backgroundColor: colors[10],
                                borderColor: borderColors[10],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI West Africa',
                                data: rawData.map(item => item.KCCI_West_Africa),
                                backgroundColor: colors[11],
                                borderColor: borderColors[11],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI China',
                                data: rawData.map(item => item.KCCI_China),
                                backgroundColor: colors[12],
                                borderColor: borderColors[12],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI Japan',
                                data: rawData.map(item => item.KCCI_Japan),
                                backgroundColor: colors[13],
                                borderColor: borderColors[13],
                                borderWidth: 1,
                                fill: false
                            },
                             {
                                label: 'KCCI Southeast Asia',
                                data: rawData.map(item => item.KCCI_Southeast_Asia),
                                backgroundColor: colors[14],
                                borderColor: borderColors[14],
                                borderWidth: 1,
                                fill: false
                            }
                        ],
                        dates
                    );

                    // Chart 2: SCFI Composite Index & Routes
                    expensesChart = setupChart(
                        'expensesChart', 'line',
                        [
                            {
                                label: 'SCFI Composite Index',
                                data: rawData.map(item => item.SCFI_Composite_Index),
                                backgroundColor: colors[1],
                                borderColor: borderColors[1],
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'SCFI US West Coast',
                                data: rawData.map(item => item.SCFI_US_West_Coast),
                                backgroundColor: colors[2],
                                borderColor: borderColors[2],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI US East Coast',
                                data: rawData.map(item => item.SCFI_US_East_Coast),
                                backgroundColor: colors[3],
                                borderColor: borderColors[3],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI North Europe',
                                data: rawData.map(item => item.SCFI_North_Europe),
                                backgroundColor: colors[4],
                                borderColor: borderColors[4],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI Mediterranean',
                                data: rawData.map(item => item.SCFI_Mediterranean),
                                backgroundColor: colors[5],
                                borderColor: borderColors[5],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI Southeast Asia',
                                data: rawData.map(item => item.SCFI_Southeast_Asia),
                                backgroundColor: colors[6],
                                borderColor: borderColors[6],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI Middle East',
                                data: rawData.map(item => item.SCFI_Middle_East),
                                backgroundColor: colors[7],
                                borderColor: borderColors[7],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI Australia/New Zealand',
                                data: rawData.map(item => item.Australia_New_Zealand_SCFI),
                                backgroundColor: colors[8],
                                borderColor: borderColors[8],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI South America',
                                data: rawData.map(item => item.South_America_SCFI),
                                backgroundColor: colors[9],
                                borderColor: borderColors[9],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI Japan West Coast',
                                data: rawData.map(item => item.Japan_West_Coast_SCFI),
                                backgroundColor: colors[10],
                                borderColor: borderColors[10],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI Japan East Coast',
                                data: rawData.map(item => item.Japan_East_Coast_SCFI),
                                backgroundColor: colors[11],
                                borderColor: borderColors[11],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI Korea',
                                data: rawData.map(item => item.Korea_SCFI),
                                backgroundColor: colors[12],
                                borderColor: borderColors[12],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI East/West Africa',
                                data: rawData.map(item => item.East_West_Africa_SCFI),
                                backgroundColor: colors[13],
                                borderColor: borderColors[13],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'SCFI South Africa',
                                data: rawData.map(item => item.South_Africa_SCFI),
                                backgroundColor: colors[14],
                                borderColor: borderColors[14],
                                borderWidth: 1,
                                fill: false
                            }
                        ],
                        dates
                    );

                    // Chart 3: WCI Composite Index & Routes
                    productSalesChart = setupChart(
                        'productSalesChart', 'line',
                        [
                            {
                                label: 'WCI Composite Index',
                                data: rawData.map(item => item.WCI_Composite_Index),
                                backgroundColor: colors[0],
                                borderColor: borderColors[0],
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'WCI Shanghai → Rotterdam',
                                data: rawData.map(item => item.Shanghai_Rotterdam_WCI),
                                backgroundColor: colors[2],
                                borderColor: borderColors[2],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'WCI Rotterdam → Shanghai',
                                data: rawData.map(item => item.Rotterdam_Shanghai_WCI),
                                backgroundColor: colors[3],
                                borderColor: borderColors[3],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'WCI Shanghai → Genoa',
                                data: rawData.map(item => item.Shanghai_Genoa_WCI),
                                backgroundColor: colors[4],
                                borderColor: borderColors[4],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'WCI Shanghai → Los Angeles',
                                data: rawData.map(item => item.Shanghai_Los_Angeles_WCI),
                                backgroundColor: colors[5],
                                borderColor: borderColors[5],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'WCI Los Angeles → Shanghai',
                                data: rawData.map(item => item.Los_Angeles_Shanghai_WCI),
                                backgroundColor: colors[6],
                                borderColor: borderColors[6],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'WCI Shanghai → New York',
                                data: rawData.map(item => item.Shanghai_New_York_WCI),
                                backgroundColor: colors[7],
                                borderColor: borderColors[7],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'WCI New York → Rotterdam',
                                data: rawData.map(item => item.New_York_Rotterdam_WCI),
                                backgroundColor: colors[8],
                                borderColor: borderColors[8],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'WCI Rotterdam → New York',
                                data: rawData.map(item => item.Rotterdam_New_York_WCI),
                                backgroundColor: colors[9],
                                borderColor: borderColors[9],
                                borderWidth: 1,
                                fill: false
                            }
                        ],
                        dates
                    );

                    // Chart 4: IACI Composite Index
                    inventoryChart = setupChart(
                        'inventoryChart', 'bar',
                        [
                            {
                                label: 'IACI Composite Index',
                                data: rawData.map(item => item.IACI_Composite_Index),
                                backgroundColor: colors[1],
                                borderColor: borderColors[1],
                                borderWidth: 1
                            }
                        ],
                        dates
                    );

                    // Chart 5: BLANK_SAILING Total & Alliances
                    satisfactionChart = setupChart(
                        'satisfactionChart', 'line',
                        [
                            {
                                label: 'Total Blank Sailings',
                                data: rawData.map(item => item.Total_Blank_Sailings),
                                backgroundColor: colors[0],
                                borderColor: borderColors[0],
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Gemini Cooperation',
                                data: rawData.map(item => item.Gemini_Cooperation_Blank_Sailing),
                                backgroundColor: colors[2],
                                borderColor: borderColors[2],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'MSC Alliance',
                                data: rawData.map(item => item.MSC_Alliance_Blank_Sailing),
                                backgroundColor: colors[3],
                                borderColor: borderColors[3],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'OCEAN Alliance',
                                data: rawData.map(item => item.OCEAN_Alliance_Blank_Sailing),
                                backgroundColor: colors[4],
                                borderColor: borderColors[4],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'Premier Alliance',
                                data: rawData.map(item => item.Premier_Alliance_Blank_Sailing),
                                backgroundColor: colors[5],
                                borderColor: borderColors[5],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'Others/Independent',
                                data: rawData.map(item => item.Others_Independent_Blank_Sailing),
                                backgroundColor: colors[6],
                                borderColor: borderColors[6],
                                borderWidth: 1,
                                fill: false
                            }
                        ],
                        dates
                    );

                    // Chart 6: FBX Composite Index & Routes
                    trafficChart = setupChart(
                        'trafficChart', 'line',
                        [
                            {
                                label: 'FBX Composite Index',
                                data: rawData.map(item => item.FBX_Composite_Index),
                                backgroundColor: colors[1],
                                borderColor: borderColors[1],
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'FBX China/EA → US West Coast',
                                data: rawData.map(item => item.China_EA_US_West_Coast_FBX),
                                backgroundColor: colors[2],
                                borderColor: borderColors[2],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX US West Coast → China/EA',
                                data: rawData.map(item => item.US_West_Coast_China_EA_FBX),
                                backgroundColor: colors[3],
                                borderColor: borderColors[3],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX China/EA → US East Coast',
                                data: rawData.map(item => item.China_EA_US_East_Coast_FBX),
                                backgroundColor: colors[4],
                                borderColor: borderColors[4],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX US East Coast → China/EA',
                                data: rawData.map(item => item.US_East_Coast_China_EA_FBX),
                                backgroundColor: colors[5],
                                borderColor: borderColors[5],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX China/EA → North Europe',
                                data: rawData.map(item => item.China_EA_North_Europe_FBX),
                                backgroundColor: colors[6],
                                borderColor: borderColors[6],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX North Europe → China/EA',
                                data: rawData.map(item => item.North_Europe_China_EA_FBX),
                                backgroundColor: colors[7],
                                borderColor: borderColors[7],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX China/EA → Mediterranean',
                                data: rawData.map(item => item.China_EA_Mediterranean_FBX),
                                backgroundColor: colors[8],
                                borderColor: borderColors[8],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX Mediterranean → China/EA',
                                data: rawData.map(item => item.Mediterranean_China_EA_FBX),
                                backgroundColor: colors[9],
                                borderColor: borderColors[9],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX US East Coast → North Europe',
                                data: rawData.map(item => item.FBX_US_East_Coast_North_Europe),
                                backgroundColor: colors[10],
                                borderColor: borderColors[10],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX North Europe → US East Coast',
                                data: rawData.map(item => item.FBX_North_Europe_US_East_Coast),
                                backgroundColor: colors[11],
                                borderColor: borderColors[11],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX Europe → South America East Coast',
                                data: rawData.map(item => item.FBX_Europe_South_America_East_Coast),
                                backgroundColor: colors[12],
                                borderColor: borderColors[12],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'FBX Europe → South America West Coast',
                                data: rawData.map(item => item.FBX_Europe_South_America_West_Coast),
                                backgroundColor: colors[13],
                                borderColor: borderColors[13],
                                borderWidth: 1,
                                fill: false
                            }
                        ],
                        dates
                    );

                    // Chart 7: XSI Routes
                    productivityChart = setupChart(
                        'productivityChart', 'line',
                        [
                            {
                                label: 'XSI East Asia → North Europe',
                                data: rawData.map(item => item.XSI_East_Asia_North_Europe),
                                backgroundColor: colors[0],
                                borderColor: borderColors[0],
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'XSI North Europe → East Asia',
                                data: rawData.map(item => item.XSI_North_Europe_East_Asia),
                                backgroundColor: colors[1],
                                borderColor: borderColors[1],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'XSI East Asia → US West Coast',
                                data: rawData.map(item => item.XSI_East_Asia_US_West_Coast),
                                backgroundColor: colors[2],
                                borderColor: borderColors[2],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'XSI US West Coast → East Asia',
                                data: rawData.map(item => item.XSI_US_West_Coast_East_Asia),
                                backgroundColor: colors[3],
                                borderColor: borderColors[3],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'XSI East Asia → South America East Coast',
                                data: rawData.map(item => item.XSI_East_Asia_South_America_East_Coast),
                                backgroundColor: colors[4],
                                borderColor: borderColors[4],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'XSI North Europe → US East Coast',
                                data: rawData.map(item => item.XSI_North_Europe_US_East_Coast),
                                backgroundColor: colors[5],
                                borderColor: borderColors[5],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'XSI US East Coast → North Europe',
                                data: rawData.map(item => item.XSI_US_East_Coast_North_Europe),
                                backgroundColor: colors[6],
                                borderColor: borderColors[6],
                                borderWidth: 1,
                                fill: false
                            },
                            {
                                label: 'XSI North Europe → South America East Coast',
                                data: rawData.map(item => item.XSI_North_Europe_South_America_East_Coast),
                                backgroundColor: colors[7],
                                borderColor: borderColors[7],
                                borderWidth: 1,
                                fill: false
                            }
                        ],
                        dates
                    );

                    // Chart 8: MBCI Index
                    mbciChart = setupChart(
                        'mbciChart', 'line',
                        [
                            {
                                label: 'MBCI Value',
                                data: rawData.map(item => item.MBCI_MBCI_Value),
                                backgroundColor: colors[1],
                                borderColor: borderColors[1],
                                borderWidth: 2,
                                fill: false
                            }
                        ],
                        dates
                    );

                    // Start the chart slider after all charts are initialized
                    showChartSlide(currentChartSlide);
                    setInterval(nextChartSlide, chartSlideInterval);

                } catch (error) {
                    console.error("Error loading or processing JSON data:", error);
                    // Display an error message if data loading fails
                    document.querySelector('.chart-slider-container').innerHTML = '<p class="placeholder-text" style="color: red;">Error loading chart data. Please check the console.</p>';
                }
            }

            // Initial world clock update and 1-second interval update
            updateWorldClocks();
            setInterval(updateWorldClocks, 1000);

            // Update last updated time
            document.getElementById('last-updated').textContent = `Last Updated: ${new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true })}`;

            // Start loading JSON data and displaying the dashboard
            loadAndDisplayData();
        });
    </script>
</body>
</html>
